# Extension Schema Reference
# ==========================
# This file documents every property accepted in a _schema.yml file
# for Quarto extensions. Place _schema.yml alongside _extension.yml
# inside an extension directory.
#
# YAML files use kebab-case for multi-word property names.
# JSON files use camelCase (see extension-schema.json).

# Schema version URI. Declares which schema format this file follows.
# Quarto Wizard warns on unrecognised versions but does not reject them.
$schema: https://m.canouil.dev/quarto-wizard/assets/schema/v1/extension-schema.json

# ---------------------------------------------------------------------------
# options
# ---------------------------------------------------------------------------
# Extension-level configuration options. Users set these under the extension
# name in _quarto.yml, _metadata.yml, or document front matter:
#
#   extensions:
#     my-ext:
#       theme: dark
#       count: 5
options:
  # A string option with enum constraints and case-insensitive matching.
  theme:
    type: string
    description: "Colour theme for the extension output."
    required: false
    default: light
    enum:
      - light
      - dark
      - auto
    enum-case-insensitive: true
    aliases:
      - colour-scheme

  # A numeric option with inclusive and exclusive bounds.
  opacity:
    type: number
    description: "Opacity level between 0 and 1 (exclusive of both endpoints)."
    default: 0.5
    exclusive-minimum: 0
    exclusive-maximum: 1

  # An integer option with inclusive min/max bounds.
  # "minimum" and "maximum" are accepted aliases for "min" and "max".
  count:
    type: number
    description: "Number of items to display."
    default: 3
    min: 1
    max: 100

  # A string option with pattern validation.
  slug:
    type: string
    description: "URL-safe identifier for the output."
    pattern: "^[a-z0-9-]+$"
    pattern-exact: true
    min-length: 1
    max-length: 64

  # A boolean option.
  enabled:
    type: boolean
    description: "Enable or disable the extension."
    default: true

  # A constant value (must equal this exact value when provided).
  version:
    type: string
    const: "1.0"
    description: "Schema version marker (must be exactly '1.0')."

  # A union type accepting either a number or a boolean.
  fade-duration:
    type:
      - number
      - boolean
    default: 100
    description: "Fade duration in milliseconds. Set to false to disable."

  # An array option with item schema and array length constraints.
  tags:
    type: array
    description: "List of classification tags."
    min-items: 1
    max-items: 10
    items:
      type: string
      min-length: 1

  # An object option with nested property descriptors.
  badge:
    type: object
    description: "Badge configuration."
    properties:
      key:
        type: string
        required: true
        description: "Unique identifier for the badge."
      colour:
        type: string
        aliases:
          - color
        description: "Background colour."
        completion:
          type: color

  # A deprecated option (boolean form).
  old-flag:
    type: boolean
    deprecated: true

  # A deprecated option (string message form).
  legacy-mode:
    type: string
    deprecated: "Use 'theme' instead."

  # A deprecated option (structured object form with auto-forwarding).
  old-colour:
    type: string
    deprecated:
      since: "1.2"
      message: "Use 'theme' instead."
      replace-with: theme

  # A field with file completion.
  logo:
    type: string
    description: "Path to a logo image file."
    completion:
      type: file
      extensions:
        - .png
        - .svg
        - .jpg

  # A field with freeform completion and placeholder.
  custom-css:
    type: string
    description: "Custom CSS class name."
    completion:
      type: freeform
      placeholder: "e.g. my-custom-class"

  # A field with dynamic completion.
  brand-colour:
    type: string
    description: "Colour from the project brand palette."
    completion:
      type: enum
      dynamic: true
      source: brand-colors

# ---------------------------------------------------------------------------
# shortcodes
# ---------------------------------------------------------------------------
# Per-shortcode schemas. Each key is the shortcode name as used in
# {{< shortcode-name ... >}} syntax.
shortcodes:
  placeholder:
    description: "Generate a placeholder image with specified dimensions."
    # Positional arguments (ordered array). Each entry must include "name".
    arguments:
      - name: width
        type: number
        required: true
        description: "Image width in pixels."
        min: 1
      - name: height
        type: number
        description: "Image height in pixels."
        default: 150
      # A content argument accepts Pandoc inlines/blocks, not just strings.
      - name: caption
        type: content
        description: "Caption text or Pandoc content for the image."
    # Named attributes (key-value map).
    attributes:
      format:
        type: string
        enum:
          - png
          - jpg
          - svg
        default: png
        description: "Output image format."
      alt:
        type: string
        description: "Alternative text for accessibility."
        max-length: 200

# ---------------------------------------------------------------------------
# formats
# ---------------------------------------------------------------------------
# Per-format options. Each key is a format name as it appears under
# "format:" in YAML metadata (e.g., "letter-pdf", "invoice-html").
formats:
  letter-pdf:
    address:
      type: array
      required: true
      description: "Recipient address lines."
      items:
        type: string
    opening:
      type: string
      default: "Dear Sir or Madam,"
      description: "Opening salutation."

# ---------------------------------------------------------------------------
# element-attributes
# ---------------------------------------------------------------------------
# Attributes accepted by filter extensions on Pandoc Div, Span, CodeBlock,
# and Header elements. Groups are matched against the current element:
#
#   _any           - matches any element regardless of class, ID, or type.
#   <class-name>   - matches elements carrying that CSS class.
#   <element-type> - matches by Pandoc element type (Div, Span, Code,
#                    CodeBlock, Header).
#   <id-prefix>    - matches elements whose ID starts with <prefix>-.
element-attributes:
  # Attributes that apply to any element.
  _any:
    colour:
      type: string
      aliases:
        - color
        - ink
        - fg
      description: "Text (foreground) colour."
      completion:
        type: color
  # Attributes that apply only to elements with class "panel".
  panel:
    title:
      type: string
      description: "Panel heading text."
      required: true
  # Attributes matched by Pandoc element type.
  CodeBlock:
    filename:
      type: string
      description: "Display filename label for the code block."

# ---------------------------------------------------------------------------
# projects
# ---------------------------------------------------------------------------
# Project-level options. Each key is a project type name.
projects:
  my-website:
    output-dir:
      type: string
      default: _site
      description: "Output directory for the built website."
