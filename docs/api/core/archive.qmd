---
title: "Archive"
---

## Archive Extraction Module

Unified archive extraction for ZIP and TAR.GZ formats.

Provides format detection, extraction, and cleanup utilities for archive files.

### Interfaces

- [DiscoveredExtension](archive.qmd#symbol-interface-discoveredextension)
- [ExtractOptions](archive.qmd#symbol-interface-extractoptions)
- [ExtractResult](archive.qmd#symbol-interface-extractresult)

### Functions

- [cleanupExtraction](archive.qmd#symbol-function-cleanupextraction)
- [detectArchiveFormat](archive.qmd#symbol-function-detectarchiveformat)
- [extractArchive](archive.qmd#symbol-function-extractarchive)
- [findAllExtensionRoots](archive.qmd#symbol-function-findallextensionroots)
- [findExtensionRoot](archive.qmd#symbol-function-findextensionroot)

## Archive Security Module

Shared security utilities for archive extraction.

Provides path traversal detection and size formatting used by both
ZIP and TAR extractors.

### Variables

- [DEFAULT_MAX_SIZE](archive.qmd#symbol-variable-default-max-size)
- [MAX_COMPRESSION_RATIO](archive.qmd#symbol-variable-max-compression-ratio)
- [MAX_FILE_COUNT](archive.qmd#symbol-variable-max-file-count)

### Functions

- [checkPathTraversal](archive.qmd#symbol-function-checkpathtraversal)
- [formatSize](archive.qmd#symbol-function-formatsize)
- [validateUrlProtocol](archive.qmd#symbol-function-validateurlprotocol)

## TAR.GZ Archive Extraction Module

TAR.GZ archive extraction with security checks.

Includes protection against path traversal and oversized archives.

### Interfaces

- [TarExtractOptions](archive.qmd#symbol-interface-tarextractoptions)

### Functions

- [extractTar](archive.qmd#symbol-function-extracttar)

## ZIP Archive Extraction Module

ZIP archive extraction with security checks.

Includes protection against path traversal and zip bomb attacks.

### Interfaces

- [ZipExtractOptions](archive.qmd#symbol-interface-zipextractoptions)

### Functions

- [extractZip](archive.qmd#symbol-function-extractzip)

## checkPathTraversal {#symbol-function-checkpathtraversal}

```{.ts filename="TypeScript"}
function checkPathTraversal(filePath): void;
```

Defined in: [packages/core/src/archive/security.ts:29](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/security.ts#L29)

Check for path traversal attempts in archive entry paths.

### Parameters

| Parameter  | Type     | Description                 |
| ---------- | -------- | --------------------------- |
| `filePath` | `string` | Entry path from the archive |

### Returns

`void`

### Throws

SecurityError if path traversal is detected

## cleanupExtraction {#symbol-function-cleanupextraction}

```{.ts filename="TypeScript"}
function cleanupExtraction(extractDir): Promise<void>;
```

Defined in: [packages/core/src/archive/extract.ts:243](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L243)

Clean up a temporary extraction directory.

### Parameters

| Parameter    | Type     | Description         |
| ------------ | -------- | ------------------- |
| `extractDir` | `string` | Directory to remove |

### Returns

`Promise<void>`

## detectArchiveFormat {#symbol-function-detectarchiveformat}

```{.ts filename="TypeScript"}
function detectArchiveFormat(archivePath): "zip" | "tarball" | null;
```

Defined in: [packages/core/src/archive/extract.ts:43](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L43)

Detect archive format from file path.

### Parameters

| Parameter     | Type     |
| ------------- | -------- |
| `archivePath` | `string` |

### Returns

`"zip"` \| `"tarball"` \| `null`

## extractArchive {#symbol-function-extractarchive}

```{.ts filename="TypeScript"}
function extractArchive(archivePath, options?): Promise<ExtractResult>;
```

Defined in: [packages/core/src/archive/extract.ts:64](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L64)

Extract an archive to a temporary directory.

### Parameters

| Parameter     | Type                                                            | Description              |
| ------------- | --------------------------------------------------------------- | ------------------------ |
| `archivePath` | `string`                                                        | Path to the archive file |
| `options`     | [`ExtractOptions`](archive.qmd#symbol-interface-extractoptions) | Extraction options       |

### Returns

`<code>Promise&lt;<a href="archive.qmd#symbol-interface-extractresult" style="text-decoration-line: underline; text-decoration-style: dashed; text-decoration-thickness: 1px; text-decoration-color: currentColor;">ExtractResult</a>&gt;</code>`{=html}

Extraction result

## extractTar {#symbol-function-extracttar}

```{.ts filename="TypeScript"}
function extractTar(
   archivePath,
   destDir,
options?): Promise<string[]>;
```

Defined in: [packages/core/src/archive/tar.ts:34](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/tar.ts#L34)

Extract a TAR.GZ archive to a directory.

### Parameters

| Parameter     | Type                                                                  | Description             |
| ------------- | --------------------------------------------------------------------- | ----------------------- |
| `archivePath` | `string`                                                              | Path to the TAR.GZ file |
| `destDir`     | `string`                                                              | Destination directory   |
| `options`     | [`TarExtractOptions`](archive.qmd#symbol-interface-tarextractoptions) | Extraction options      |

### Returns

`Promise<string[]>`

List of extracted file paths

## extractZip {#symbol-function-extractzip}

```{.ts filename="TypeScript"}
function extractZip(
   archivePath,
   destDir,
options?): Promise<string[]>;
```

Defined in: [packages/core/src/archive/zip.ts:34](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/zip.ts#L34)

Extract a ZIP archive to a directory.

### Parameters

| Parameter     | Type                                                                  | Description           |
| ------------- | --------------------------------------------------------------------- | --------------------- |
| `archivePath` | `string`                                                              | Path to the ZIP file  |
| `destDir`     | `string`                                                              | Destination directory |
| `options`     | [`ZipExtractOptions`](archive.qmd#symbol-interface-zipextractoptions) | Extraction options    |

### Returns

`Promise<string[]>`

List of extracted file paths

## findAllExtensionRoots {#symbol-function-findallextensionroots}

```{.ts filename="TypeScript"}
function findAllExtensionRoots(extractDir): Promise<DiscoveredExtension[]>;
```

Defined in: [packages/core/src/archive/extract.ts:204](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L204)

Find all extension roots in an extracted archive.

Unlike findExtensionRoot which returns the first match, this function
finds all extensions in the archive, useful for repositories that
contain multiple extensions.

### Parameters

| Parameter    | Type     | Description          |
| ------------ | -------- | -------------------- |
| `extractDir` | `string` | Extraction directory |

### Returns

`<code>Promise&lt;<a href="archive.qmd#symbol-interface-discoveredextension" style="text-decoration-line: underline; text-decoration-style: dashed; text-decoration-thickness: 1px; text-decoration-color: currentColor;">DiscoveredExtension</a>[]&gt;</code>`{=html}

Array of discovered extensions

## findExtensionRoot {#symbol-function-findextensionroot}

```{.ts filename="TypeScript"}
function findExtensionRoot(extractDir, depth?): Promise<string | null>;
```

Defined in: [packages/core/src/archive/extract.ts:120](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L120)

Find the extension root in an extracted archive.

GitHub archives typically have a top-level directory like "repo-tag/".
This function finds the directory containing \_extension.yml.

### Parameters

| Parameter    | Type     | Default value | Description                            |
| ------------ | -------- | ------------- | -------------------------------------- |
| `extractDir` | `string` | `undefined`   | Extraction directory                   |
| `depth`      | `number` | `0`           | Current recursion depth (internal use) |

### Returns

`Promise<string | null>`

Path to extension root or null if not found

## formatSize {#symbol-function-formatsize}

```{.ts filename="TypeScript"}
function formatSize(bytes): string;
```

Defined in: [packages/core/src/archive/security.ts:70](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/security.ts#L70)

Format a byte count for display.

### Parameters

| Parameter | Type     | Description     |
| --------- | -------- | --------------- |
| `bytes`   | `number` | Number of bytes |

### Returns

`string`

Human-readable size string

## validateUrlProtocol {#symbol-function-validateurlprotocol}

```{.ts filename="TypeScript"}
function validateUrlProtocol(url): void;
```

Defined in: [packages/core/src/archive/security.ts:50](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/security.ts#L50)

Validate that a URL uses an allowed protocol.

Prevents SSRF by rejecting file://, ftp://, and other non-HTTP protocols.

### Parameters

| Parameter | Type     | Description            |
| --------- | -------- | ---------------------- |
| `url`     | `string` | URL string to validate |

### Returns

`void`

### Throws

SecurityError if the protocol is not allowed

## DiscoveredExtension {#symbol-interface-discoveredextension}

Defined in: [packages/core/src/archive/extract.ts:159](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L159)

Information about a discovered extension in an archive.

### Properties

| Property                                          | Type               | Description                                                                 | Defined in                                                                                                                                                                    |
| ------------------------------------------------- | ------------------ | --------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <a id="property-id"></a> `id`                     | `object`           | Extension ID derived from directory structure.                              | [packages/core/src/archive/extract.ts:165](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L165) |
| `id.name`                                         | `string`           | -                                                                           | [packages/core/src/archive/extract.ts:165](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L165) |
| `id.owner`                                        | `string` \| `null` | -                                                                           | [packages/core/src/archive/extract.ts:165](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L165) |
| <a id="property-path"></a> `path`                 | `string`           | Absolute path to the extension root (directory containing \_extension.yml). | [packages/core/src/archive/extract.ts:161](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L161) |
| <a id="property-relativepath"></a> `relativePath` | `string`           | Path relative to the extraction root (for display purposes).                | [packages/core/src/archive/extract.ts:163](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L163) |

## ExtractOptions {#symbol-interface-extractoptions}

Defined in: [packages/core/src/archive/extract.ts:21](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L21)

Options for archive extraction.

### Properties

| Property                                       | Type               | Description                             | Defined in                                                                                                                                                                  |
| ---------------------------------------------- | ------------------ | --------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <a id="property-maxsize"></a> `maxSize?`       | `number`           | Maximum total extraction size in bytes. | [packages/core/src/archive/extract.ts:23](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L23) |
| <a id="property-onprogress"></a> `onProgress?` | (`file`) => `void` | Progress callback.                      | [packages/core/src/archive/extract.ts:25](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L25) |

## ExtractResult {#symbol-interface-extractresult}

Defined in: [packages/core/src/archive/extract.ts:31](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L31)

Result of archive extraction.

### Properties

| Property                                      | Type                   | Description                       | Defined in                                                                                                                                                                  |
| --------------------------------------------- | ---------------------- | --------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <a id="property-extractdir"></a> `extractDir` | `string`               | Path to the extraction directory. | [packages/core/src/archive/extract.ts:33](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L33) |
| <a id="property-files"></a> `files`           | `string[]`             | List of extracted file paths.     | [packages/core/src/archive/extract.ts:35](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L35) |
| <a id="property-format"></a> `format`         | `"zip"` \| `"tarball"` | Detected archive format.          | [packages/core/src/archive/extract.ts:37](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/extract.ts#L37) |

## TarExtractOptions {#symbol-interface-tarextractoptions}

Defined in: [packages/core/src/archive/tar.ts:19](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/tar.ts#L19)

Options for TAR extraction.

### Properties

| Property                                       | Type               | Description                             | Defined in                                                                                                                                                          |
| ---------------------------------------------- | ------------------ | --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <a id="property-maxsize"></a> `maxSize?`       | `number`           | Maximum total extraction size in bytes. | [packages/core/src/archive/tar.ts:21](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/tar.ts#L21) |
| <a id="property-onprogress"></a> `onProgress?` | (`file`) => `void` | Progress callback.                      | [packages/core/src/archive/tar.ts:23](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/tar.ts#L23) |

## ZipExtractOptions {#symbol-interface-zipextractoptions}

Defined in: [packages/core/src/archive/zip.ts:19](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/zip.ts#L19)

Options for ZIP extraction.

### Properties

| Property                                       | Type               | Description                             | Defined in                                                                                                                                                          |
| ---------------------------------------------- | ------------------ | --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <a id="property-maxsize"></a> `maxSize?`       | `number`           | Maximum total extraction size in bytes. | [packages/core/src/archive/zip.ts:21](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/zip.ts#L21) |
| <a id="property-onprogress"></a> `onProgress?` | (`file`) => `void` | Progress callback.                      | [packages/core/src/archive/zip.ts:23](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/zip.ts#L23) |

## DEFAULT_MAX_SIZE {#symbol-variable-default-max-size}

```{.ts filename="TypeScript"}
const DEFAULT_MAX_SIZE: number;
```

Defined in: [packages/core/src/archive/security.ts:15](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/security.ts#L15)

Default maximum extraction size: 100 MB.

## MAX_COMPRESSION_RATIO {#symbol-variable-max-compression-ratio}

```{.ts filename="TypeScript"}
const MAX_COMPRESSION_RATIO: 100 = 100;
```

Defined in: [packages/core/src/archive/security.ts:18](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/security.ts#L18)

Maximum compression ratio allowed.

## MAX_FILE_COUNT {#symbol-variable-max-file-count}

```{.ts filename="TypeScript"}
const MAX_FILE_COUNT: 10000 = 10_000;
```

Defined in: [packages/core/src/archive/security.ts:21](https://github.com/mcanouil/quarto-wizard/blob/b137ce01c347ae00b9119bd3b64f63ca147770fe/packages/core/src/archive/security.ts#L21)

Maximum number of entries allowed in an archive.
