{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"$id": "https://m.canouil.dev/quarto-wizard/assets/schema/v1/extension-schema.json",
	"title": "Quarto Extension Schema Definition",
	"description": "Describes the structure of _schema.yml / _schema.json files used by Quarto extensions.",
	"type": "object",
	"additionalProperties": false,
	"properties": {
		"$schema": {
			"type": "string",
			"format": "uri",
			"description": "Schema version URI."
		},
		"options": {
			"$ref": "#/$defs/fieldDescriptorMap",
			"description": "Extension-level configuration options."
		},
		"shortcodes": {
			"$ref": "#/$defs/shortcodeMap",
			"description": "Per-shortcode schemas."
		},
		"formats": {
			"$ref": "#/$defs/formatsMap",
			"description": "Per-format options."
		},
		"projects": {
			"type": "array",
			"items": { "type": "string" },
			"description": "Project types contributed by the extension (suggested for project.type)."
		},
		"attributes": {
			"$ref": "#/$defs/attributesMap",
			"description": "Attributes accepted by filter extensions on Pandoc elements, grouped by class, ID, or element type."
		},
		"classes": {
			"$ref": "#/$defs/classesMap",
			"description": "CSS classes contributed by the extension, with optional descriptions."
		}
	},
	"$defs": {
		"typeEnum": {
			"type": "string",
			"enum": ["string", "number", "integer", "boolean", "array", "object", "content"]
		},
		"completionSpec": {
			"type": "object",
			"description": "Completion specification for the field.",
			"properties": {
				"type": {
					"type": "string",
					"description": "Completion type (e.g., file, color, enum, freeform)."
				},
				"extensions": {
					"type": "array",
					"items": { "type": "string" },
					"description": "File extensions to filter by (for type: file)."
				},
				"placeholder": {
					"type": "string",
					"description": "Placeholder text (for type: freeform)."
				},
				"values": {
					"type": "array",
					"items": { "type": "string" },
					"description": "Static value list (for type: enum)."
				},
				"dynamic": {
					"type": "boolean",
					"description": "Whether values are resolved dynamically."
				},
				"source": {
					"type": "string",
					"description": "Source identifier for dynamic values."
				}
			}
		},
		"deprecatedSpec": {
			"type": "object",
			"description": "Structured deprecation descriptor.",
			"properties": {
				"since": {
					"type": "string",
					"description": "Version since which the field is deprecated."
				},
				"message": {
					"type": "string",
					"description": "Deprecation message."
				},
				"replace-with": {
					"type": "string",
					"description": "Replacement field name (kebab-case)."
				},
				"replaceWith": {
					"type": "string",
					"description": "Replacement field name (camelCase)."
				}
			}
		},
		"fieldDescriptor": {
			"type": "object",
			"additionalProperties": false,
			"properties": {
				"type": {
					"description": "Data type (string, number, integer, boolean, array, object, content).",
					"oneOf": [
						{ "$ref": "#/$defs/typeEnum" },
						{ "type": "array", "items": { "$ref": "#/$defs/typeEnum" } }
					]
				},
				"required": {
					"type": "boolean",
					"description": "Whether this field is required."
				},
				"default": {
					"description": "Default value when not specified."
				},
				"description": {
					"type": "string",
					"description": "Human-readable description shown in editor hints."
				},
				"enum": {
					"type": "array",
					"description": "List of allowed values.",
					"x-snippet": ":\n  - $0"
				},
				"enumCaseInsensitive": {
					"type": "boolean",
					"description": "Whether enum matching ignores case (camelCase variant).",
					"x-yaml-hidden": true
				},
				"enum-case-insensitive": {
					"type": "boolean",
					"description": "Whether enum matching ignores case.",
					"x-boolean-property": true
				},
				"pattern": {
					"type": "string",
					"description": "Regular expression the value must match."
				},
				"patternExact": {
					"type": "boolean",
					"description": "Whether the pattern must match the entire value (camelCase variant).",
					"x-yaml-hidden": true
				},
				"pattern-exact": {
					"type": "boolean",
					"description": "Whether the pattern must match the entire value.",
					"x-boolean-property": true
				},
				"min": {
					"type": "number",
					"description": "Minimum numeric value."
				},
				"max": {
					"type": "number",
					"description": "Maximum numeric value."
				},
				"minimum": {
					"type": "number",
					"description": "Minimum numeric value (JSON Schema alias).",
					"x-yaml-hidden": true
				},
				"maximum": {
					"type": "number",
					"description": "Maximum numeric value (JSON Schema alias).",
					"x-yaml-hidden": true
				},
				"exclusiveMinimum": {
					"type": "number",
					"description": "Exclusive minimum (camelCase variant).",
					"x-yaml-hidden": true
				},
				"exclusive-minimum": {
					"type": "number",
					"description": "Exclusive minimum (value must be strictly greater)."
				},
				"exclusiveMaximum": {
					"type": "number",
					"description": "Exclusive maximum (camelCase variant).",
					"x-yaml-hidden": true
				},
				"exclusive-maximum": {
					"type": "number",
					"description": "Exclusive maximum (value must be strictly less)."
				},
				"minLength": {
					"type": "integer",
					"description": "Minimum string length (camelCase variant).",
					"x-yaml-hidden": true
				},
				"min-length": {
					"type": "integer",
					"description": "Minimum string length."
				},
				"maxLength": {
					"type": "integer",
					"description": "Maximum string length (camelCase variant).",
					"x-yaml-hidden": true
				},
				"max-length": {
					"type": "integer",
					"description": "Maximum string length."
				},
				"minItems": {
					"type": "integer",
					"description": "Minimum number of items (camelCase variant).",
					"x-yaml-hidden": true
				},
				"min-items": {
					"type": "integer",
					"description": "Minimum number of items (for arrays)."
				},
				"maxItems": {
					"type": "integer",
					"description": "Maximum number of items (camelCase variant).",
					"x-yaml-hidden": true
				},
				"max-items": {
					"type": "integer",
					"description": "Maximum number of items (for arrays)."
				},
				"const": {
					"description": "Fixed value the field must equal."
				},
				"aliases": {
					"type": "array",
					"items": { "type": "string" },
					"description": "Alternative names for the field.",
					"x-snippet": ":\n  - $0"
				},
				"deprecated": {
					"description": "Whether the field is deprecated.",
					"x-boolean-property": true,
					"oneOf": [
						{ "type": "boolean" },
						{ "type": "string" },
						{ "$ref": "#/$defs/deprecatedSpec" }
					]
				},
				"completion": {
					"$ref": "#/$defs/completionSpec",
					"description": "Completion specification for the field.",
					"x-nested-property": true
				},
				"items": {
					"$ref": "#/$defs/fieldDescriptor",
					"description": "Schema for array items (when type is array).",
					"x-nested-property": true
				},
				"properties": {
					"$ref": "#/$defs/fieldDescriptorMap",
					"description": "Schema for nested object properties (when type is object).",
					"x-nested-property": true
				},
				"name": {
					"type": "string",
					"description": "Name of the shortcode argument (required).",
					"x-shortcode-argument-only": true
				}
			}
		},
		"fieldDescriptorMap": {
			"type": "object",
			"additionalProperties": {
				"$ref": "#/$defs/fieldDescriptor"
			}
		},
		"shortcodeEntry": {
			"type": "object",
			"additionalProperties": false,
			"properties": {
				"description": {
					"type": "string",
					"description": "Human-readable description of the shortcode."
				},
				"arguments": {
					"type": "array",
					"items": { "$ref": "#/$defs/fieldDescriptor" },
					"description": "Positional arguments accepted by the shortcode.",
					"x-nested-property": true,
					"x-snippet": ":\n  - $0"
				},
				"attributes": {
					"$ref": "#/$defs/fieldDescriptorMap",
					"description": "Named attributes accepted by the shortcode.",
					"x-nested-property": true,
					"x-snippet": ":\n  $0"
				}
			}
		},
		"shortcodeMap": {
			"type": "object",
			"additionalProperties": {
				"$ref": "#/$defs/shortcodeEntry"
			}
		},
		"formatsMap": {
			"type": "object",
			"additionalProperties": {
				"$ref": "#/$defs/fieldDescriptorMap"
			}
		},
		"attributesMap": {
			"type": "object",
			"additionalProperties": {
				"$ref": "#/$defs/fieldDescriptorMap"
			}
		},
		"classEntry": {
			"type": "object",
			"properties": {
				"description": {
					"type": "string",
					"description": "Human-readable description of the class."
				}
			}
		},
		"classesMap": {
			"type": "object",
			"additionalProperties": {
				"$ref": "#/$defs/classEntry"
			}
		}
	}
}
